<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login</title>
  <link rel="stylesheet" href="signup.css">
</head>
<body>
  <h2>Login</h2>
  <form id="loginForm">
    <label>M-PIN</label>
    <input name="mpin" placeholder="XXX-XXX" type="password" inputmode="numeric" maxlength="6" pattern="\d{4,6}" required />
    <button type="submit">Login</button>
  </form>
  <p><a href="forgot-mpin.html">Forgot your mPIN?</a></p>
  <div id="msg" style="color:#b00020"></div>

  <p class="switch-link">
    Don't have an account? <a href="signup.html">Sign Up</a>
  </p>
<script>
const say = t => document.querySelector('#msg').textContent = t || '';
document.querySelector('#loginForm').onsubmit = async (e) => {
  e.preventDefault(); say('');
  const fd = new FormData(e.target);
  const mpin = (fd.get('mpin') || '').trim();
  if (!/^\d{4,6}$/.test(mpin)) return say('Invalid mPIN');

  const r = await fetch('login.php', {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({mpin})});
  const d = await r.json();
  if (!d.success) return say(d.error || 'Login failed');
  location.href = 'index.php'; // or your dashboard path
};
</script>
</body>
</html>
